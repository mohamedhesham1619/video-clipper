<!DOCTYPE html>
<html>
<head>
    <title>Update Floating Buttons</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
        }
        button:hover {
            background-color: #45a049;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Update Floating Buttons</h1>
    <p>This tool will remove the old floating button from all HTML files and ensure the new one is properly set up.</p>
    
    <div id="status">
        <p>Click the button below to start the update.</p>
    </div>
    
    <button id="updateBtn">Update All Files</button>
    
    <div id="results"></div>

    <script>
        const files = [
            'index.html',
            'pages/contact.html',
            'pages/faq.html',
            'pages/privacy.html',
            'pages/supported-sites.html',
            'pages/terms.html'
        ];

        function addResult(message, isError = false) {
            const result = document.createElement('div');
            result.className = `result ${isError ? 'error' : 'success'}`;
            result.textContent = message;
            document.getElementById('results').appendChild(result);
            return result;
        }

        async function updateFile(file) {
            try {
                const response = await fetch(file);
                if (!response.ok) throw new Error(`Failed to fetch ${file}`);
                
                let content = await response.text();
                
                // Remove the old floating button
                const oldButtonRegex = /<!--\s*Floating contact button[\s\S]*?<\/button>\s*/i;
                const newContent = content.replace(oldButtonRegex, '<!-- Floating button will be added here by main.js -->\n');
                
                if (content === newContent) {
                    return { file, updated: false, message: `No changes needed for ${file}` };
                }
                
                // In a real implementation, you would save the file here
                // For security reasons, this is a simulation
                return { 
                    file, 
                    updated: true, 
                    message: `Updated ${file} - Removed old floating button`,
                    content: newContent
                };
                
            } catch (error) {
                return { file, updated: false, message: `Error processing ${file}: ${error.message}`, error: true };
            }
        }

        async function updateAllFiles() {
            const btn = document.getElementById('updateBtn');
            btn.disabled = true;
            btn.textContent = 'Updating...';
            
            const results = [];
            
            for (const file of files) {
                const result = await updateFile(file);
                results.push(result);
                
                const resultElement = addResult(result.message, result.error);
                if (result.updated) {
                    const pre = document.createElement('pre');
                    pre.textContent = `Please update ${file} manually by removing the old floating button HTML.`;
                    resultElement.appendChild(pre);
                }
                
                // Small delay to avoid overwhelming the browser
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            const updatedCount = results.filter(r => r.updated).length;
            const errorCount = results.filter(r => r.error).length;
            
            addResult(`\nUpdate complete! ${updatedCount} files updated, ${errorCount} errors.`);
            
            btn.textContent = 'Update Complete';
        }

        document.getElementById('updateBtn').addEventListener('click', updateAllFiles);
    </script>
</body>
</html>
